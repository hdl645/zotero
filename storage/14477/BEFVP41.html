<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<meta name="wpd_version" content="0.2">
<meta name="wpd_baseurl" content="http://www.freeswan.ca/docs/BEFVP41/">
<meta name="wpd_url" content="http://www.freeswan.ca/docs/BEFVP41/">
<meta name="wpd_date" content="2008-06-04T08:41Z">




 
  <title>

   freeswan.ca: FreeS/WAN Linksys BEFVP41 Inter-Op
  </title>
 </head>
<body text="#000000" vlink="#000077" alink="#fe0000" bgcolor="#ffffff" link="#191990">
  <table valign="top" width="600" align="center" bgcolor="#ffffff" cellspacing="0">
   <tbody><tr>
    <td colspan="2">
     <table width="100%" border="0" cellpadding="0" cellspacing="0">
      <tbody><tr>
       <td bgcolor="#ffffff">
	<img src="freeswan-penguin.png" alt="[Penguin]">
       </td>
       <td align="center">
	<img src="freeswan-text.png" alt="Freeswan.ca">
       </td>
      </tr>
      <tr>
       <td colspan="2">

     <table width="100%" border="0" cellpadding="0" cellspacing="0">
      <tbody><tr>
       <td bgcolor="#aaaaaa">
        <table width="100%" border="0" cellpadding="0" cellspacing="2">
         <tbody><tr>	
          <td width="99%" align="right" bgcolor="#dddddd">
           <font size="1" color="#000000">
            <b>
             <a href="http://www.freeswan.ca/">H o m e</a>
            </b>
           </font>
           <font size="3" color="#aaaaaa">
            <b>

             |
            </b>
           </font>
           <font size="1" color="#000000">
            <b>
             <a href="http://www.freeswan.ca/about.php">A b o u t</a>
            </b>
           </font>
           <font size="3" color="#aaaaaa">
            <b>

             |
            </b>
           </font>
           <font size="1" color="#000000">
            <b>
             <a href="http://www.freeswan.ca/download.php">D o w n l o a d</a>
            </b>
           </font>
           <font size="3" color="#aaaaaa">
            <b>

             |
            </b>
           </font>
           <font size="1" color="#000000">
            <b>
             <a href="http://www.freeswan.ca/support.php">S u p p o r t</a>
            </b>
           </font>
           <font size="3" color="#aaaaaa">
            <b>

             |
            </b>
           </font>
           <font size="1" color="#000000">
            <b>
             <a href="http://www.freeswan.ca/development">D e v e l o p m e n t</a>
            </b>
           </font>
           <font size="3" color="#aaaaaa">
            <b>

             |
            </b>
           </font>
           <font size="1" color="#000000">
            <b>
             <a href="http://www.freeswan.ca/patches/">P a t c h e s</a>
            </b>
           </font>
           <font size="3" color="#aaaaaa">
            <b>

             |
            </b>
           </font>
           <font size="1" color="#000000">
            <b>
             <a href="http://www.freeswan.ca/misc.php">L i n k s</a>
            </b>
           </font>
           <font size="3" color="#aaaaaa">
            <b>

             |
            </b>
           </font>
           <font size="1" color="#000000">
            <b>
             <a href="http://www.freeswan.ca/search.php">S e a r c h</a>&nbsp;&nbsp;
            </b>
           </font>


          </td>
         </tr>				
        </tbody></table>
       </td>
      </tr>
     </tbody></table>
       </td>
      </tr>
     </tbody></table>

    </td>
   </tr>

  <tr>
<td colspan="2">
<script type="text/javascript"><!--
google_ad_client = "pub-1135353426426797";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text_image";
google_ad_channel ="www.freeswan.ca";
oogle_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script style="display: none;" type="text/javascript" src="show_ads.js">
</script>

</td>
</tr>


   <tr>
    <td colspan="2">
     <br>
     <font size="2" color="#000000">
      </font><p>
</p><table width="100%" border="1" bordercolor="#000000" cellpadding="0" cellspacing="0" height="137">
                            <tbody><tr> 
                              <td bgcolor="#dddddd" height="23"> 
                                <div align="left"><font size="+1" color="#000000"><a name="contact"><b>&nbsp;FreeS/WAN to Linksys BEFVP41 DSL VPN Router Interoperability Guide</b></a></font></div>
                              </td>
                            </tr>
                            <tr> 
                              <td valign="top" height="157"> 
                                  <font color="#000000">
					</font><div align="right"><font color="#000000"><font size="-2">2008-07-04&nbsp;&nbsp;</font></font></div>
<h2><font color="#000000">1. Typical Configuration</font></h2>
<center><font color="#000000"><img src="config.gif"></font></center>

<p>

</p><h2><font color="#000000">2. Linksys BEFVP41 Configuration Settings</font></h2>

<center><font color="#000000"><img src="befvp41_vpn.jpg" border="1"></font></center>
<p>
<font color="#000000">Local Secure Group: The network behind the Linksys BEFVP41<br>
Remote Secure Group: The network behind the FreeS/WAN Gateway<br>
Remote Security Gateway: Use either <layer id="google-toolbar-hilite-0" style="background-color: Chartreuse; color: black;">IP</layer> Address or FQDN, and set this to the address of the FreeS/WAN Security
Gateway.</font></p><p>

</p><center><font color="#000000"><img src="befvp41_advanced.jpg" border="1"></font></center>
<p>
<font color="#000000">You <b>must</b> use the above settings exactly as shown for this to work.<br>
By default, the BEFVP41 only uses single DES with a 786-bit group in<br>
the proposals.  As FreeS/WAN doesn't support single DES, this is rejected, <br>
and Phase 2 is never reached.

</font></p><h2><font color="#000000">3. FreeS/WAN Configuration</font></h2>
<font color="#000000">If you have remote sites with static <layer id="google-toolbar-hilite-1" style="background-color: Chartreuse; color: black;">IP</layer> addresses, you can specify them by <layer id="google-toolbar-hilite-2" style="background-color: Chartreuse; color: black;">IP</layer> address instead of %any.  This way
you can have an unlimited number of remote sites, with different PreShared Keys (a good idea)
</font><p>
</p><pre><font color="#000000">/etc/ipsec.conf:

# We keep with tradition - left = local, right = remote

# This is our roadwarrior connection
conn rw_linksys_to_freeswan
        right=%any
        rightsubnet=192.168.100.0/24	# If they have a network behind them - see section 4!
        rightnexthop=1.1.1.1		# Irrelevent
        left=123.123.123.2
        leftsubnet=10.10.0.0/16
        leftnexthop=123.123.123.1
        keyexchange=ike
        ikelifetime=240m
        keylife=60m
        pfs=yes
        compress=no
        authby=secret
        auto=add

# This is a connection for a remote site w/Static <layer id="google-toolbar-hilite-3" style="background-color: Chartreuse; color: black;">IP</layer>
conn static_linksys_to_freeswan
        right=24.1.1.2
	rightsubnet=192.168.101.0/24
        rightnexthop=24.1.1.1
        left=123.123.123.2
        leftsubnet=10.10.0.0/16
        leftnexthop=123.123.123.1
        keyexchange=ike
        ikelifetime=240m
        keylife=60m
        pfs=yes
        compress=no
        authby=secret
        auto=add

/etc/ipsec.secrets:

# Same PSK for all Roadwarriors, so keep it protected
123.123.123.2 %any : PSK "SOME KEY HERE"
123.123.123.2 24.1.1.2 : PSK "STATIC REMOTE SITE PSK"

</font></pre>

<h2><font color="#000000">4. Known Caveats/Limitations</font></h2>

<font color="#000000">There are a number of limitations with this configuration if your remote host is a roadwarrior.

</font><ol>
<font color="#000000"><li>You can't use RSA Keys for any other road warrior connections.
</li><li>If your roadwarriors have networks behind them, you can only have 1 roadwarrior.
</li><li>All roadwarriors must use the same PreShared Key (insecure!)
</li></font></ol>

<font color="#000000">				</font>
                              </td>
                            </tr>
                          </tbody></table>
<font size="2" color="#000000">      </font>
     <br>
    </td>
   </tr>
   <tr>
    <td colspan="2">
     <table width="100%" border="0" cellpadding="0" cellspacing="0">
      <tbody><tr>
       <td bgcolor="#aaaaaa">
        <table width="100%" border="0" cellpadding="0" cellspacing="2">
         <tbody><tr>	
          <td width="99%" bgcolor="#dddddd">
           <font size="3" color="#aaaaaa">
            <b>
             &nbsp;
            </b>
           </font>
          </td>
         </tr>				
        </tbody></table>
       </td>
      </tr>
     </tbody></table>
    </td>
   </tr>
   <tr>
    <td colspan="2">

<!-- Sponsor/Hosting/Contact Info -->

<table width="100%">
<tbody><tr><td>
<!--
	<font  color="#aaaaaa" size="1">
		Sponsored by: <BR>
	</font>
	<a href=http://www.astaro.com/php/statics.php?action=asl&lang=gb><img src="/img/sponsor.gif" alt="Sponsored by Astaro" border=0></a>
-->
</td>
<td valign="top" width="50%">
</td>
<td align="right">
</td>
</tr>
</tbody></table>
<!-- End of Sponsor/Hosting/Contact Info -->

    </td>
   </tr>
  </tbody></table>
 
</body>
</html>
